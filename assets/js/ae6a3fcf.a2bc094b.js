"use strict";(self.webpackChunkying_blog=self.webpackChunkying_blog||[]).push([[8382],{9613:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>m});var r=t(9496);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),p=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},c=function(e){var n=p(e.components);return r.createElement(l.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},g=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),d=p(t),g=a,m=d["".concat(l,".").concat(g)]||d[g]||u[g]||s;return t?r.createElement(m,i(i({ref:n},c),{},{components:t})):r.createElement(m,i({ref:n},c))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=t.length,i=new Array(s);i[0]=g;var o={};for(var l in n)hasOwnProperty.call(n,l)&&(o[l]=n[l]);o.originalType=e,o[d]="string"==typeof e?e:a,i[1]=o;for(var p=2;p<s;p++)i[p]=t[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}g.displayName="MDXCreateElement"},6658:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>p});var r=t(8957),a=(t(9496),t(9613));const s={id:"docking-register-api",sidebar_label:"\u5bf9\u63a5\u6ce8\u518c\u63a5\u53e3",title:"\u5bf9\u63a5\u6ce8\u518c\u63a5\u53e3"},i=void 0,o={unversionedId:"ying-chat/docking-register-api",id:"ying-chat/docking-register-api",title:"\u5bf9\u63a5\u6ce8\u518c\u63a5\u53e3",description:"\u672c\u8282\u5c06\u5728\u5ba2\u6237\u7aef\u5bf9\u63a5\u6ce8\u518c\u63a5\u53e3\u3002",source:"@site/docs/ying-chat/09-docking-register-api.md",sourceDirName:"ying-chat",slug:"/ying-chat/docking-register-api",permalink:"/docs/ying-chat/docking-register-api",draft:!1,tags:[],version:"current",sidebarPosition:9,frontMatter:{id:"docking-register-api",sidebar_label:"\u5bf9\u63a5\u6ce8\u518c\u63a5\u53e3",title:"\u5bf9\u63a5\u6ce8\u518c\u63a5\u53e3"},sidebar:"yingChat",previous:{title:"\u524d\u540e\u7aef\u5171\u7528 DTO \u6821\u9a8c",permalink:"/docs/ying-chat/dto-validation-and-openapi-doc"},next:{title:"\u767b\u5f55\u4e0e\u9274\u6743\u5b9e\u73b0",permalink:"/docs/ying-chat/login-and-auth-api"}},l={},p=[{value:"\u8868\u5355\u68c0\u9a8c\u903b\u8f91",id:"\u8868\u5355\u68c0\u9a8c\u903b\u8f91",level:2},{value:"\u63a5\u53e3\u521d\u59cb\u5316",id:"\u63a5\u53e3\u521d\u59cb\u5316",level:2},{value:"\u5bf9\u63a5\u6ce8\u518c\u63a5\u53e3",id:"\u5bf9\u63a5\u6ce8\u518c\u63a5\u53e3",level:2},{value:"\u52a0\u5165\u5168\u5c40 toast \u63d0\u793a",id:"\u52a0\u5165\u5168\u5c40-toast-\u63d0\u793a",level:2}],c={toc:p},d="wrapper";function u(e){let{components:n,...s}=e;return(0,a.kt)(d,(0,r.Z)({},c,s,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"\u672c\u8282\u5c06\u5728\u5ba2\u6237\u7aef\u5bf9\u63a5\u6ce8\u518c\u63a5\u53e3\u3002"),(0,a.kt)("h2",{id:"\u8868\u5355\u68c0\u9a8c\u903b\u8f91"},"\u8868\u5355\u68c0\u9a8c\u903b\u8f91"),(0,a.kt)("p",null,"\u6211\u4eec\u5c06\u901a\u8fc7 ",(0,a.kt)("inlineCode",{parentName:"p"},"react-hook-form")," \u6765\u5b9e\u73b0\u8868\u5355\u6821\u9a8c\uff0c\u540c\u65f6\u4ece ",(0,a.kt)("inlineCode",{parentName:"p"},"@hookform/resolvers")," \u91cc\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"class-validator")," \u8fd9\u4e2a ",(0,a.kt)("inlineCode",{parentName:"p"},"resolver")," \u53bb\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"@ying-chat/shared")," \u5bfc\u51fa\u7684 DTO \u7c7b\uff0c\u8fd9\u6837\u524d\u7aef\u4e5f\u53ef\u4ee5\u548c\u540e\u7aef\u4e00\u6837\u53bb\u68c0\u9a8c\u540c\u4e00\u4e2a\u7c7b\u4e86\u3002"),(0,a.kt)("p",null,"\u5148\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"client")," \u4e0b\u8f7d\u4ee5\u4e0b\u4f9d\u8d56\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell",metastring:'title="apps/client"',title:'"apps/client"'},"pnpm i react-hook-form @hookform/resolvers\n")),(0,a.kt)("p",null,"\u4fee\u6539\u6ce8\u518c\u9875\u9762\uff0c\u52a0\u5165\u8868\u5355\u6821\u9a8c\u903b\u8f91\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="apps/client/src/pages/account/register.tsx"',title:'"apps/client/src/pages/account/register.tsx"'},'// ...\nimport { RegisterDto } from \'@ying-chat/shared\'\nimport { useForm } from \'react-hook-form\'\nimport { classValidatorResolver } from \'@hookform/resolvers/class-validator\'\n\nconst resolver = classValidatorResolver(RegisterDto)\n\nexport const Register = () => {\n  const navigate = useNavigate()\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors }\n  } = useForm<RegisterDto>({\n    resolver\n  })\n\n  const registerAccount = async () => {\n    console.log(\'registerAccount\')\n  }\n\n  return (\n    //...\n    <form onSubmit={handleSubmit(registerAccount)}>\n      <Input\n        endContent={<CircleUserRound />}\n        label="Username"\n        autoComplete="new-username"\n        variant="underlined"\n        isInvalid={Boolean(errors.username)}\n        errorMessage={errors.username?.message}\n        {...register(\'username\')}\n      />\n      <Input\n        endContent={<Mail />}\n        label="Email"\n        variant="underlined"\n        isInvalid={Boolean(errors.email)}\n        errorMessage={errors.email?.message}\n        {...register(\'email\')}\n      />\n      <Input\n        endContent={<Lock />}\n        type="password"\n        label="Password"\n        autoComplete="new-password"\n        variant="underlined"\n        isInvalid={Boolean(errors.password)}\n        errorMessage={errors.password?.message}\n        {...register(\'password\')}\n      />\n      <Input\n        endContent={<Lock />}\n        type="password"\n        label="Input password again"\n        autoComplete="off"\n        variant="underlined"\n      />\n\n      <Input\n        label="Code"\n        variant="underlined"\n        maxLength={6}\n        isInvalid={Boolean(errors.code)}\n        errorMessage={errors.code?.message}\n        {...register(\'code\')}\n        endContent={\n          <Button color="primary" radius="sm">\n            Send Code\n          </Button>\n        }\n      />\n\n      <div className="flex flex-col gap-4 mt-4">\n        <Button color="primary" type="submit">\n          Register now\n        </Button>\n        <Button\n          variant="ghost"\n          onClick={() => {\n            navigate(\'/login\')\n          }}\n        >\n          Log in now\n        </Button>\n      </div>\n    </form>\n    //...\n  )\n}\n')),(0,a.kt)("p",null,"\u6548\u679c\u5982\u4e0b"),(0,a.kt)("p",null,(0,a.kt)("img",{src:t(1634).Z,width:"711",height:"852"})),(0,a.kt)("p",null,"\u53ef\u4ee5\u770b\u5230\u8fd8\u5dee\u4e00\u4e2a\u518d\u6b21\u8f93\u5165\u5bc6\u7801\u7684\u68c0\u9a8c\uff0c\u76f4\u63a5\u68c0\u9a8c\u53ea\u9700\u68c0\u67e5\u662f\u5426\u548c\u524d\u9762\u8f93\u5165\u7684\u5bc6\u7801\u4e00\u81f4\u5373\u53ef\uff0c\u4f46\u662f\u8fd9\u4e2a\u68c0\u9a8c\u670d\u52a1\u7aef\u5e76\u6ca1\u6709\u53bb\u5199\uff0c\u800c\u524d\u7aef\u9700\u8981\uff0c\u540c\u65f6 ",(0,a.kt)("inlineCode",{parentName:"p"},"class-validator")," \u4e5f\u5e76\u6ca1\u6709\u63d0\u4f9b\u5bf9\u5e94\u7684\u6ce8\u89e3\u53bb\u76f4\u63a5\u5224\u65ad\u4e00\u4e2a\u5b57\u6bb5\u7684\u503c\u662f\u5426\u548c\u53e6\u4e00\u4e2a\u76f8\u7b49\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u6765\u52a0\u4e00\u4e2a\u8fd9\u6837\u7684\u6ce8\u89e3\u3002"),(0,a.kt)("p",null,"\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"shared")," \u5305\u65b0\u5efa\u4e00\u4e2a ",(0,a.kt)("inlineCode",{parentName:"p"},"validation")," \u6587\u4ef6\u5939\uff0c\u7136\u540e\u6dfb\u52a0\u4e00\u4e2a ",(0,a.kt)("inlineCode",{parentName:"p"},"equal-to.validation.ts"),"\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="packages/shared/src/validation/equal-to.validation.ts"',title:'"packages/shared/src/validation/equal-to.validation.ts"'},"import {\n  registerDecorator,\n  ValidationOptions,\n  ValidationArguments\n} from 'class-validator'\n\nexport function IsEqualTo(\n  property: string,\n  validationOptions?: ValidationOptions\n) {\n  return function (object: object, propertyName: string) {\n    registerDecorator({\n      name: 'isEqualTo',\n      target: object.constructor,\n      propertyName: propertyName,\n      constraints: [property],\n      options: validationOptions,\n      validator: {\n        validate(value: any, args: ValidationArguments) {\n          const [relatedPropertyName] = args.constraints\n          const relatedValue = (args.object as any)[relatedPropertyName]\n          return value === relatedValue\n        }\n      }\n    })\n  }\n}\n")),(0,a.kt)("p",null,"\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"validation")," \u6587\u4ef6\u5939\u65b0\u5efa\u4e00\u4e2a ",(0,a.kt)("inlineCode",{parentName:"p"},"index.ts")," \u5bfc\u51fa\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="packages/shared/src/validation/index.ts"',title:'"packages/shared/src/validation/index.ts"'},"export * from './equal-to.validation'\n")),(0,a.kt)("p",null,"\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"src")," \u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"index.ts")," \u5bfc\u51fa\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="packages/shared/src/index.ts"',title:'"packages/shared/src/index.ts"'},"// ...\nexport * from './validation'\n")),(0,a.kt)("p",null,"\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"auth.dto.ts")," \u91cc\u518d\u52a0 \u4e00\u4e2a ",(0,a.kt)("inlineCode",{parentName:"p"},"RegisterDtoWithSubPass")," \u7ee7\u627f\u81ea ",(0,a.kt)("inlineCode",{parentName:"p"},"RegisterDto"),"\uff0c\u7136\u540e\u91cc\u9762\u518d\u5b9e\u73b0\u4e00\u4e2a ",(0,a.kt)("inlineCode",{parentName:"p"},"subPassword")," \u5e76\u4f7f\u7528\u521a\u521a\u7f16\u5199\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"IsEqualTo")," \u6ce8\u89e3\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="packages/shared/src/dto/auth.dto.ts"',title:'"packages/shared/src/dto/auth.dto.ts"'},"// ...\nimport { IsEqualTo } from '../validation'\n\n// ...\n\nexport class RegisterDtoWithSubPass extends RegisterDto {\n  @IsNotEmpty({ message: 'Please input your Password again!' })\n  @IsEqualTo('password', {\n    message: 'Entered passwords differ from the another!'\n  })\n  subPassword: string\n}\n")),(0,a.kt)("p",null,"\u518d\u6b21\u91cd\u65b0\u6253\u5305\u4e00\u4e0b ",(0,a.kt)("inlineCode",{parentName:"p"},"shared"),"\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell",metastring:'title="/"',title:'"/"'},"pnpm build:pkg\n")),(0,a.kt)("p",null,"\u4fee\u6539\u6ce8\u518c\u9875\u9762\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"RegisterDto")," \u4e3a ",(0,a.kt)("inlineCode",{parentName:"p"},"RegisterDtoWithSubPass")," \u5373\u53ef\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="apps/client/src/pages/account/register.tsx"',title:'"apps/client/src/pages/account/register.tsx"'},'// ...\nimport { RegisterDtoWithSubPass } from \'@ying-chat/shared\'\n// ...\n\nconst resolver = classValidatorResolver(RegisterDtoWithSubPass)\n\nexport const Register = () => {\n  // ...\n  const {\n    register,\n    handleSubmit,\n    formState: { errors }\n  } = useForm<RegisterDtoWithSubPass>({\n    resolver\n  })\n\n  // ...\n\n  return (\n    //...\n    <Input\n      endContent={<Lock />}\n      type="password"\n      label="Input password again"\n      autoComplete="off"\n      variant="underlined"\n      isInvalid={Boolean(errors.subPassword)}\n      errorMessage={errors.subPassword?.message}\n      {...register(\'subPassword\')}\n    />\n    //...\n  )\n}\n')),(0,a.kt)("p",null,"\u5982\u679c\u53d1\u73b0\u8fd0\u884c\u6709\u62a5\u9519\u628a\u9879\u76ee\u91cd\u542f\u4e00\u4e0b\uff0c\u6700\u540e\u518d\u6b21\u6d4b\u8bd5\u4e00\u4e0b\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{src:t(6326).Z,width:"754",height:"912"})),(0,a.kt)("h2",{id:"\u63a5\u53e3\u521d\u59cb\u5316"},"\u63a5\u53e3\u521d\u59cb\u5316"),(0,a.kt)("p",null,"\u5148\u4e0b\u8f7d ",(0,a.kt)("inlineCode",{parentName:"p"},"axios"),"\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell",metastring:'title="apps/client"',title:'"apps/client"'},"pnpm i axios\n")),(0,a.kt)("p",null,"\u5ba2\u6237\u7aef\u65b0\u5efa\u4e00\u4e2a ",(0,a.kt)("inlineCode",{parentName:"p"},"api")," \u76ee\u5f55\uff0c\u7f16\u5199\u4e00\u4e2a ",(0,a.kt)("inlineCode",{parentName:"p"},"request.ts")," \u6587\u4ef6\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="apps/client/src/api/request.ts"',title:'"apps/client/src/api/request.ts"'},"import axios, { AxiosError } from 'axios'\n\nexport const request = axios.create({\n  baseURL: '/api'\n})\n\nexport type ErrorRes = {\n  status: number\n  message: string | string[]\n  timestamp?: string\n  path?: string\n  [key: string]: unknown\n}\n\nrequest.interceptors.request.use((config) => {\n  return config\n})\n\nrequest.interceptors.response.use(\n  (response) => {\n    if (response.data.data) {\n      return response.data.data\n    }\n    return response.data\n  },\n  (error: AxiosError<ErrorRes>) => {\n    return Promise.reject(error)\n  }\n)\n")),(0,a.kt)("p",null,"\u7136\u540e\u6dfb\u52a0\u4e00\u4e2a ",(0,a.kt)("inlineCode",{parentName:"p"},"auth.ts")," \u6587\u4ef6\uff0c\u5199\u597d\u6ce8\u518c\u548c\u53d1\u9001\u9a8c\u8bc1\u7801\u63a5\u53e3\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="apps/client/src/api/auth.ts"',title:'"apps/client/src/api/auth.ts"'},"import { RegisterDto } from '@ying-chat/shared'\nimport { request } from './request'\n\nexport function register(body: RegisterDto) {\n  return request.post('/auth/register', body)\n}\n\nexport async function sendCode(email: string) {\n  return request.post('/auth/sendCode', { email })\n}\n")),(0,a.kt)("p",null,"\u65b0\u5efa\u4e00\u4e2a ",(0,a.kt)("inlineCode",{parentName:"p"},"index.ts")," \u53bb\u5bfc\u51fa\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="apps/client/src/api/index.ts"',title:'"apps/client/src/api/index.ts"'},"import * as authApi from './auth'\n\nexport { authApi }\n")),(0,a.kt)("p",null,"\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"vite.config.ts")," \u6dfb\u52a0\u63a5\u53e3\u4ee3\u7406\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="apps/client/vite.config.ts"',title:'"apps/client/vite.config.ts"'},"// ...\nexport default defineConfig({\n  // ...\n  server: {\n    proxy: {\n      '/api': {\n        target: 'http://localhost:3000'\n      }\n    }\n  }\n})\n")),(0,a.kt)("h2",{id:"\u5bf9\u63a5\u6ce8\u518c\u63a5\u53e3"},"\u5bf9\u63a5\u6ce8\u518c\u63a5\u53e3"),(0,a.kt)("p",null,"\u5230\u6b64\u7684\u8bdd\u63a5\u53e3\u5df2\u7ecf\u51c6\u5907\u5b8c\u6bd5\u4e86\uff0c\u63a5\u4e0b\u6765\u9700\u8981\u5f00\u59cb\u5bf9\u63a5\u6ce8\u518c\u63a5\u53e3\u3002"),(0,a.kt)("p",null,"\u4fee\u6539\u6ce8\u518c\u9875\u9762\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="apps/client/src/pages/account/register.tsx"',title:'"apps/client/src/pages/account/register.tsx"'},'// ...\nimport { useState } from \'react\'\nimport { authApi } from \'@/api\'\n\n// ...\n\nexport const Register = () => {\n  const navigate = useNavigate()\n\n  const {\n    register,\n    handleSubmit,\n    getValues, // +\n    formState: { errors }\n  } = useForm<RegisterDtoWithSubPass>({\n    resolver\n  })\n\n  const [sendCodeLoading, setSendCodeLoading] = useState(false)\n  const [registerLoading, setRegisterLoading] = useState(false)\n\n  const sendCode = async () => {\n    const email = getValues(\'email\')\n\n    if (!email) {\n      return\n    }\n    try {\n      setSendCodeLoading(true)\n      await authApi.sendCode(email)\n    } catch {\n    } finally {\n      setSendCodeLoading(false)\n    }\n  }\n\n  const registerAccount = async (values: RegisterDtoWithSubPass) => {\n    try {\n      setRegisterLoading(true)\n      await authApi.register(Object.assign(values, { subPassword: undefined }))\n      navigate(\'/login\')\n    } catch {\n    } finally {\n      setRegisterLoading(false)\n    }\n  }\n\n  return (\n    // ...\n    <Input\n      label="Code"\n      variant="underlined"\n      maxLength={6}\n      isInvalid={Boolean(errors.code)}\n      errorMessage={errors.code?.message}\n      {...register(\'code\')}\n      endContent={\n        <Button\n          color="primary"\n          radius="sm"\n          isLoading={sendCodeLoading}\n          onClick={sendCode}\n        >\n          Send Code\n        </Button>\n      }\n    />\n\n    <div className="flex flex-col gap-4 mt-4">\n      <Button color="primary" type="submit" isLoading={registerLoading}>\n        Register now\n      </Button>\n      <Button\n        variant="ghost"\n        onClick={() => {\n          navigate(\'/login\')\n        }}\n      >\n        Log in now\n      </Button>\n    </div>\n    // ...\n  )\n}\n')),(0,a.kt)("p",null,"\u8fd9\u4e2a\u65f6\u5019\u5c06\u4f1a\u770b\u5230\u7f16\u8f91\u5668\u62a5\u4e86 eslint \u7684\u9519\u8bef\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{src:t(47).Z,width:"868",height:"895"})),(0,a.kt)("p",null,"\u73b0\u5728\u662f\u4e0d\u5141\u8bb8\u6709\u7a7a\u7684\u5757\u8bed\u53e5\u7684\uff0c\u90a3\u6211\u4eec\u6539\u4e00\u4e0b eslint \u914d\u7f6e\uff0c\u5141\u8bb8\u7a7a\u7684\u5757\u51fa\u73b0\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="apps/client/.eslintrc.cjs"',title:'"apps/client/.eslintrc.cjs"'},"module.exports = {\n  // ...\n  rules: {\n    'no-empty': 'off', // +\n    'react-refresh/only-export-components': [\n      'warn',\n      { allowConstantExport: true }\n    ]\n  }\n}\n")),(0,a.kt)("p",null,"\u8fd9\u6837\u5c31\u4e0d\u4f1a\u62a5\u9519\u4e86\uff0c"),(0,a.kt)("h2",{id:"\u52a0\u5165\u5168\u5c40-toast-\u63d0\u793a"},"\u52a0\u5165\u5168\u5c40 toast \u63d0\u793a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell",metastring:'title="apps/client"',title:'"apps/client"'},"pnpm i sonner\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://sonner.emilkowal.ski/"},"sonner \u6587\u6863")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="apps/client/src/App.tsx"',title:'"apps/client/src/App.tsx"'},'// ...\nimport { Toaster } from \'sonner\'\n\nfunction App() {\n  return (\n    <ThemeProvider defaultTheme="dark">\n      <Toaster richColors position="top-center" />\n      <RouterProvider router={router}></RouterProvider>\n    </ThemeProvider>\n  )\n}\n\nexport default App\n')),(0,a.kt)("p",null,"\u7ed9\u6ce8\u518c\u9875\u9762\u7528\u6237\u7684\u64cd\u4f5c\u6dfb\u52a0\u53cd\u9988\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="apps/client/src/pages/account/register.tsx"',title:'"apps/client/src/pages/account/register.tsx"'},"// ...\nimport { toast } from 'sonner'\n\nexport const Register = () => {\n  // ...\n\n  const sendCode = async () => {\n    const email = getValues('email')\n\n    if (!email) {\n      return toast.warning('Please input your email first!') // +\n    }\n    try {\n      setSendCodeLoading(true)\n      await authApi.sendCode(email)\n      toast.success('send code success!') // +\n    } catch {\n    } finally {\n      setSendCodeLoading(false)\n    }\n  }\n\n  const registerAccount = async (values: RegisterDtoWithSubPass) => {\n    try {\n      setRegisterLoading(true)\n      await authApi.register(Object.assign(values, { subPassword: undefined }))\n      toast.success('register success!') // +\n      navigate('/login')\n    } catch {\n    } finally {\n      setRegisterLoading(false)\n    }\n  }\n\n  return (\n    // ...\n  )\n}\n")),(0,a.kt)("p",null,"\u5728\u63a5\u53e3\u62e6\u622a\u91cc\u7edf\u4e00\u6dfb\u52a0\u9519\u8bef\u63d0\u793a\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="apps/client/src/api/request.ts"',title:'"apps/client/src/api/request.ts"'},"// ...\nimport { toast } from 'sonner'\n\n// ...\n\nrequest.interceptors.response.use(\n  (response) => {\n    if (response.data.data) {\n      return response.data.data\n    }\n    return response.data\n  },\n  (error: AxiosError<ErrorRes>) => {\n    const res = error.response\n    if (res) {\n      const msg = res.data.message\n      if (Array.isArray(msg)) {\n        toast.error(msg[0])\n      } else {\n        toast.error(msg)\n      }\n      return Promise.reject(res.data)\n    }\n    return Promise.reject(error)\n  }\n)\n")),(0,a.kt)("p",null,"\u90a3\u4e48\u6700\u540e\u5c31\u53ef\u4ee5\u81ea\u884c\u8c03\u8bd5\u4e00\u4e0b\u6574\u4e2a\u6ce8\u518c\u6d41\u7a0b\u662f\u5426\u6b63\u5e38\u4e86\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{src:t(3919).Z,width:"1920",height:"1080"})),(0,a.kt)("p",null,"\u672c\u8282\u5230\u6b64\u7ed3\u675f\u3002"))}u.isMDXComponent=!0},1634:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/01-5e88c52fb502eaa8fbc2f2f1a64dfc18.png"},6326:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/02-ec482e25a8f6245e63023e8b878c3ad4.gif"},47:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/03-fe696baa24483d9ee1c9ed70ec1b7f46.png"},3919:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/05-06d33868fe4f1b92d74967fdbf668f83.gif"}}]);