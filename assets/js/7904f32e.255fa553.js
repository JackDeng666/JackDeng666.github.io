"use strict";(self.webpackChunkying_blog=self.webpackChunkying_blog||[]).push([[1589],{5729:(r,n,e)=>{e.r(n),e.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var o=e(3274),t=e(9128);const a={id:"docking-group-api",sidebar_label:"\u5ba2\u6237\u7aef\u5bf9\u63a5\u7fa4\u7ec4api",title:"\u5ba2\u6237\u7aef\u5bf9\u63a5\u7fa4\u7ec4api"},s=void 0,i={id:"ying-chat/docking-group-api",title:"\u5ba2\u6237\u7aef\u5bf9\u63a5\u7fa4\u7ec4api",description:"\u672c\u8282\u6765\u5bf9\u63a5\u4e0a\u8282\u7684\u7fa4\u804a api\u3002",source:"@site/docs/ying-chat/15-docking-group-api.md",sourceDirName:"ying-chat",slug:"/ying-chat/docking-group-api",permalink:"/docs/ying-chat/docking-group-api",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:15,frontMatter:{id:"docking-group-api",sidebar_label:"\u5ba2\u6237\u7aef\u5bf9\u63a5\u7fa4\u7ec4api",title:"\u5ba2\u6237\u7aef\u5bf9\u63a5\u7fa4\u7ec4api"},sidebar:"yingChat",previous:{title:"\u7fa4\u7ec4\u76f8\u5173api\u5b9e\u73b0",permalink:"/docs/ying-chat/group-api"},next:{title:"\u7fa4\u804a api",permalink:"/docs/ying-chat/message-api"}},l={},c=[{value:"\u524d\u7aef\u63a5\u53e3\u51c6\u5907",id:"\u524d\u7aef\u63a5\u53e3\u51c6\u5907",level:2},{value:"vo \u6587\u4ef6\u51c6\u5907",id:"vo-\u6587\u4ef6\u51c6\u5907",level:3},{value:"\u63a5\u53e3\u6587\u4ef6",id:"\u63a5\u53e3\u6587\u4ef6",level:3},{value:"\u9875\u9762\u5bf9\u63a5",id:"\u9875\u9762\u5bf9\u63a5",level:2},{value:"<code>ContactPage</code>\u4fee\u6539",id:"contactpage\u4fee\u6539",level:3},{value:"\u5f39\u6846\u6dfb\u52a0",id:"\u5f39\u6846\u6dfb\u52a0",level:3},{value:"\u5728<code>Sidebar</code>\u91cc\u9762\u6dfb\u52a0\u5f39\u6846",id:"\u5728sidebar\u91cc\u9762\u6dfb\u52a0\u5f39\u6846",level:3},{value:"\u7fa4\u8be6\u60c5\u9875\u9762",id:"\u7fa4\u8be6\u60c5\u9875\u9762",level:2},{value:"\u4e8c\u7ea7\u8def\u7531\u914d\u7f6e",id:"\u4e8c\u7ea7\u8def\u7531\u914d\u7f6e",level:3},{value:"<code>ContactDetail</code>\u5b8c\u5584",id:"contactdetail\u5b8c\u5584",level:3}];function d(r){const n={code:"code",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,t.R)(),...r.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"\u672c\u8282\u6765\u5bf9\u63a5\u4e0a\u8282\u7684\u7fa4\u804a api\u3002"}),"\n",(0,o.jsx)(n.h2,{id:"\u524d\u7aef\u63a5\u53e3\u51c6\u5907",children:"\u524d\u7aef\u63a5\u53e3\u51c6\u5907"}),"\n",(0,o.jsx)(n.h3,{id:"vo-\u6587\u4ef6\u51c6\u5907",children:"vo \u6587\u4ef6\u51c6\u5907"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="packages/shared/src/vo/group.vo.ts"',children:"import { FileVo } from './file.vo'\r\nimport { UserVo } from './user.vo'\r\n\r\nexport type GroupVo = {\r\n  id: number\r\n  name: string\r\n  description?: string\r\n  inviteCode?: string\r\n  coverId: number\r\n  cover: FileVo\r\n  createById: number\r\n  createAt: string\r\n  updateAt: string\r\n  users?: UserVo[]\r\n}\r\n\r\nexport type GroupListVo = {\r\n  owner: GroupVo[]\r\n  member: GroupVo[]\r\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u5bfc\u51fa\u3002"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="packages/shared/src/vo/index.ts"',children:"// ...\r\nexport * from './group.vo'\n"})}),"\n",(0,o.jsx)(n.h3,{id:"\u63a5\u53e3\u6587\u4ef6",children:"\u63a5\u53e3\u6587\u4ef6"}),"\n",(0,o.jsxs)(n.p,{children:["\u5728",(0,o.jsx)(n.code,{children:"api"}),"\u4e0b\u65b0\u5efa\u4e00\u4e2a",(0,o.jsx)(n.code,{children:"group.ts"}),"\u63a5\u53e3\u6587\u4ef6\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="apps/client/src/api/group.ts"',children:"import { CreateGroupDto, FileVo, GroupVo, GroupListVo } from '@ying-chat/shared'\r\nimport { request } from './request'\r\n\r\nexport function createGroup(groupDto: CreateGroupDto): Promise<GroupVo> {\r\n  return request.post('/group', groupDto)\r\n}\r\n\r\nexport function uploadGroupCover(file: File): Promise<FileVo> {\r\n  const form = new FormData()\r\n  form.append('file', file)\r\n  return request.post('/group/cover', form)\r\n}\r\n\r\nexport function joinGroup(inviteCode: string): Promise<null> {\r\n  return request.get(`/group/join/${inviteCode}`)\r\n}\r\n\r\nexport function getUserGroupList(): Promise<GroupListVo> {\r\n  return request.get('/group/list')\r\n}\r\n\r\nexport function getGroupInfo(id: string): Promise<GroupVo> {\r\n  return request.get(`/group/${id}`)\r\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u5bfc\u51fa\u3002"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="apps/client/src/api/index.ts"',children:"// ...\r\nimport * as groupApi from './group'\r\n\r\nexport {\r\n  // ...\r\n  groupApi\r\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"\u9875\u9762\u5bf9\u63a5",children:"\u9875\u9762\u5bf9\u63a5"}),"\n",(0,o.jsxs)(n.h3,{id:"contactpage\u4fee\u6539",children:[(0,o.jsx)(n.code,{children:"ContactPage"}),"\u4fee\u6539"]}),"\n",(0,o.jsxs)(n.p,{children:["\u5728",(0,o.jsx)(n.code,{children:"contact"}),"\u4e0b\u9762\u6dfb\u52a0\u4e00\u4e2a",(0,o.jsx)(n.code,{children:"sidebar"}),"\u7ec4\u4ef6\u4f5c\u4e3a\u5c55\u793a\u7528\u6237\u7fa4\u5217\u8868\u7684\u5c55\u793a\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",metastring:'title="apps/client/src/pages/contact/sidebar.tsx"',children:'import { useCallback, useState, FC } from \'react\'\r\nimport {\r\n  Dropdown,\r\n  DropdownTrigger,\r\n  DropdownMenu,\r\n  DropdownItem,\r\n  Avatar,\r\n  Divider,\r\n  Accordion,\r\n  AccordionItem,\r\n  cn\r\n} from \'@nextui-org/react\'\r\nimport { ChevronRight, PlusCircle, UserPlus } from \'lucide-react\'\r\nimport { useNavigate } from \'react-router-dom\'\r\nimport { GroupListVo, GroupVo } from \'@ying-chat/shared\'\r\nimport { groupApi } from \'@/api\'\r\nimport { useApi } from \'@/api/use-api\'\r\n\r\ntype GroupListProps = {\r\n  list: GroupVo[]\r\n}\r\n\r\nconst GroupList: FC<GroupListProps> = ({ list }) => {\r\n  const navigate = useNavigate()\r\n\r\n  return (\r\n    <div>\r\n      {list.map((el, index) => (\r\n        <div\r\n          className="flex items-center p-2 w-full cursor-pointer"\r\n          key={index}\r\n        >\r\n          <Avatar className="mr-2 flex-shrink-0" src={el.cover?.url} />\r\n          <p className="text-ellipsis overflow-hidden break-all whitespace-nowrap text-base">\r\n            {el.name}\r\n          </p>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const Sidebar = () => {\r\n  const { data: group } = useApi<GroupListVo>({\r\n    func: useCallback(() => groupApi.getUserGroupList(), [])\r\n  })\r\n\r\n  const [openDropdown, setOpenDropdown] = useState(false)\r\n\r\n  return (\r\n    <div className="w-[240px] flex flex-col bg-content2">\r\n      <Dropdown\r\n        className="w-[230px]"\r\n        placement="bottom-start"\r\n        onOpenChange={open => {\r\n          setOpenDropdown(open)\r\n        }}\r\n      >\r\n        <DropdownTrigger>\r\n          <div className="flex justify-between text-lg p-2 cursor-pointer">\r\n            <p>Contact</p>\r\n            <ChevronRight\r\n              className={cn(\r\n                \'transition-all text-sm\',\r\n                openDropdown && \'rotate-90\'\r\n              )}\r\n            />\r\n          </div>\r\n        </DropdownTrigger>\r\n        <DropdownMenu aria-label="Group Actions" variant="flat">\r\n          <DropdownItem\r\n            key="user-info"\r\n            startContent={<PlusCircle className="w-5 h-5" />}\r\n          >\r\n            create a group chat\r\n          </DropdownItem>\r\n          <DropdownItem\r\n            key="change-password"\r\n            startContent={<UserPlus className="w-5 h-5" />}\r\n          >\r\n            join a group chat\r\n          </DropdownItem>\r\n        </DropdownMenu>\r\n      </Dropdown>\r\n\r\n      <Divider />\r\n\r\n      <Accordion\r\n        selectionMode="multiple"\r\n        showDivider={false}\r\n        className="flex flex-col gap-1 w-full box-border px-0"\r\n        itemClasses={{\r\n          title: \'font-normal text-sm\',\r\n          trigger: \'px-2\',\r\n          indicator: \'text-xl\'\r\n        }}\r\n      >\r\n        <AccordionItem\r\n          key="1"\r\n          aria-label="The Group I Created"\r\n          title={`The Group I Created (${group?.owner.length})`}\r\n        >\r\n          <GroupList list={group?.owner || []} />\r\n        </AccordionItem>\r\n        <AccordionItem\r\n          key="2"\r\n          aria-label="The Group I Joined"\r\n          title={`The Group I Joined (${group?.member.length})`}\r\n        >\r\n          <GroupList list={group?.member || []} />\r\n        </AccordionItem>\r\n      </Accordion>\r\n    </div>\r\n  )\r\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u4fee\u6539\u4e00\u4e0b",(0,o.jsx)(n.code,{children:"ContactPage"}),"\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",metastring:'title="apps/client/src/pages/contact/index.tsx"',children:'import { Sidebar } from \'./sidebar\'\r\n\r\nexport const ContactPage = () => {\r\n  return (\r\n    <div className="h-full flex flex-row">\r\n      <Sidebar />\r\n\r\n      <main className="flex-1"></main>\r\n    </div>\r\n  )\r\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"\u5f39\u6846\u6dfb\u52a0",children:"\u5f39\u6846\u6dfb\u52a0"}),"\n",(0,o.jsxs)(n.p,{children:["\u73b0\u5728\u8fd8\u6ca1\u6709\u521b\u5efa\u8fc7\u4efb\u4f55\u7fa4\u7ec4\uff0c\u6211\u4eec\u5148\u6dfb\u52a0\u4e24\u4e2a\u5f39\u6846\uff0c\u4e00\u4e2a\u521b\u5efa\u7fa4\u7ec4",(0,o.jsx)(n.code,{children:"GroupModal"}),"\uff0c\u4e00\u4e2a\u52a0\u5165\u7fa4\u7ec4",(0,o.jsx)(n.code,{children:"JoinGroupModal"}),"\uff0c\u5728\u91cc\u9762\u5b9e\u73b0\u5bf9\u63a5\u903b\u8f91\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",metastring:'title="apps/client/src/components/modals/group-modal.tsx"',children:"import {\r\n  Button,\r\n  Input,\r\n  Modal,\r\n  ModalBody,\r\n  ModalContent,\r\n  ModalFooter,\r\n  ModalHeader,\r\n  Textarea,\r\n  cn\r\n} from '@nextui-org/react'\r\nimport { FC, useState } from 'react'\r\nimport { toast } from 'sonner'\r\nimport { useForm } from 'react-hook-form'\r\nimport { classValidatorResolver } from '@hookform/resolvers/class-validator'\r\nimport { CreateGroupDto } from '@ying-chat/shared'\r\nimport { groupApi } from '@/api'\r\nimport { ImageUpload } from '@/components/upload/image-upload'\r\n\r\ntype UserInfoModalProps = {\r\n  open: boolean\r\n  close: () => void\r\n  confirmSuccess?: () => void\r\n}\r\n\r\nconst resolver = classValidatorResolver(CreateGroupDto)\r\n\r\nexport const GroupModal: FC<UserInfoModalProps> = ({\r\n  open,\r\n  close,\r\n  confirmSuccess\r\n}) => {\r\n  const {\r\n    register,\r\n    setValue,\r\n    reset,\r\n    handleSubmit,\r\n    formState: { errors }\r\n  } = useForm<CreateGroupDto>({\r\n    resolver\r\n  })\r\n\r\n  const [confirmLoading, setConfirmLoading] = useState(false)\r\n\r\n  const onFinish = async (values: CreateGroupDto) => {\r\n    try {\r\n      setConfirmLoading(true)\r\n      await groupApi.createGroup(values)\r\n      toast.success('Group chat successfully created!')\r\n      close()\r\n      confirmSuccess && confirmSuccess()\r\n      reset()\r\n    } catch {\r\n    } finally {\r\n      setConfirmLoading(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Modal isOpen={open} onClose={close} isDismissable={false}>\r\n      <ModalContent>\r\n        {onClose => (\r\n          <>\r\n            <ModalHeader className=\"flex flex-col gap-1\">\r\n              Create group info\r\n            </ModalHeader>\r\n            <form onSubmit={handleSubmit(onFinish)}>\r\n              <ModalBody>\r\n                <Input\r\n                  label=\"Group Name\"\r\n                  maxLength={32}\r\n                  {...register('name')}\r\n                  isInvalid={Boolean(errors.name)}\r\n                  errorMessage={errors.name?.message}\r\n                />\r\n                <Textarea\r\n                  label=\"Group Description\"\r\n                  maxRows={3}\r\n                  maxLength={100}\r\n                  {...register('description')}\r\n                  isInvalid={Boolean(errors.description)}\r\n                  errorMessage={errors.description?.message}\r\n                />\r\n                <p\r\n                  className={cn(\r\n                    'text-sm text-foreground-500',\r\n                    Boolean(errors.coverId) && 'text-danger'\r\n                  )}\r\n                >\r\n                  Group Cover\r\n                </p>\r\n                <div>\r\n                  <ImageUpload\r\n                    aria-label=\"cover\"\r\n                    handleUpload={(file: File) =>\r\n                      groupApi.uploadGroupCover(file)\r\n                    }\r\n                    onSuccess={minioFile => {\r\n                      setValue('coverId', minioFile.id)\r\n                    }}\r\n                  />\r\n                </div>\r\n                <p className=\"text-tiny text-danger\">\r\n                  {errors.coverId?.message}\r\n                </p>\r\n              </ModalBody>\r\n              <ModalFooter>\r\n                <Button\r\n                  color=\"danger\"\r\n                  variant=\"ghost\"\r\n                  isDisabled={confirmLoading}\r\n                  onPress={onClose}\r\n                >\r\n                  Close\r\n                </Button>\r\n                <Button\r\n                  color=\"primary\"\r\n                  type=\"submit\"\r\n                  isLoading={confirmLoading}\r\n                >\r\n                  Create\r\n                </Button>\r\n              </ModalFooter>\r\n            </form>\r\n          </>\r\n        )}\r\n      </ModalContent>\r\n    </Modal>\r\n  )\r\n}\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",metastring:'title="apps/client/src/components/modals/join-group-modal.tsx"',children:"import {\r\n  Button,\r\n  Input,\r\n  Modal,\r\n  ModalBody,\r\n  ModalContent,\r\n  ModalFooter,\r\n  ModalHeader\r\n} from '@nextui-org/react'\r\nimport { useState } from 'react'\r\nimport { toast } from 'sonner'\r\nimport { groupApi } from '@/api'\r\n\r\ntype JoinGroupModalProps = {\r\n  open: boolean\r\n  close: () => void\r\n  confirmSuccess?: () => void\r\n}\r\n\r\nexport const JoinGroupModal = ({\r\n  open,\r\n  close,\r\n  confirmSuccess\r\n}: JoinGroupModalProps) => {\r\n  const [inviteCode, setInviteCode] = useState('')\r\n  const [errorMessage, setErrorMessage] = useState('')\r\n  const [confirmLoading, setConfirmLoading] = useState(false)\r\n\r\n  const handleJoin = async () => {\r\n    if (!inviteCode) {\r\n      return setErrorMessage('Please input invite code!')\r\n    }\r\n    setErrorMessage('')\r\n    try {\r\n      setConfirmLoading(true)\r\n      await groupApi.joinGroup(inviteCode)\r\n      toast.success('Join the group chat successfully!')\r\n      setInviteCode('')\r\n      close()\r\n      confirmSuccess && confirmSuccess()\r\n    } catch {\r\n    } finally {\r\n      setConfirmLoading(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Modal isOpen={open} onClose={close} isDismissable={false}>\r\n      <ModalContent>\r\n        {onClose => (\r\n          <>\r\n            <ModalHeader className=\"flex flex-col gap-1\">\r\n              Join a group chat\r\n            </ModalHeader>\r\n            <ModalBody>\r\n              <Input\r\n                label=\"Invite Code\"\r\n                variant=\"underlined\"\r\n                maxLength={32}\r\n                value={inviteCode}\r\n                onChange={e => {\r\n                  setInviteCode(e.target.value)\r\n                }}\r\n                isInvalid={Boolean(errorMessage)}\r\n                errorMessage={errorMessage}\r\n              />\r\n            </ModalBody>\r\n            <ModalFooter>\r\n              <Button\r\n                color=\"danger\"\r\n                variant=\"ghost\"\r\n                isDisabled={confirmLoading}\r\n                onPress={onClose}\r\n              >\r\n                Close\r\n              </Button>\r\n              <Button\r\n                color=\"primary\"\r\n                isLoading={confirmLoading}\r\n                onPress={handleJoin}\r\n              >\r\n                Join\r\n              </Button>\r\n            </ModalFooter>\r\n          </>\r\n        )}\r\n      </ModalContent>\r\n    </Modal>\r\n  )\r\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u5bfc\u51fa\u4e00\u4e0b\u3002"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",metastring:'title="apps/client/src/components/modals/index.ts"',children:"// ...\r\nexport * from './group-modal'\r\nexport * from './join-group-modal'\n"})}),"\n",(0,o.jsxs)(n.h3,{id:"\u5728sidebar\u91cc\u9762\u6dfb\u52a0\u5f39\u6846",children:["\u5728",(0,o.jsx)(n.code,{children:"Sidebar"}),"\u91cc\u9762\u6dfb\u52a0\u5f39\u6846"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",metastring:'title="apps/client/src/pages/contact/sidebar.tsx"',children:'// ...\r\nimport { GroupModal, JoinGroupModal } from \'@/components/modals\'\r\n\r\n// ...\r\n\r\nexport const Sidebar = () => {\r\n  const { data: group, run: getGroupList } = useApi<GroupListVo>({\r\n    func: useCallback(() => groupApi.getUserGroupList(), [])\r\n  })\r\n\r\n  const [openDropdown, setOpenDropdown] = useState(false)\r\n\r\n  const [openGroupModal, setOpenGroupModal] = useState(false)\r\n  const [openJoinGroupModal, setOpenJoinGroupModal] = useState(false)\r\n\r\n  return (\r\n    <div className="w-[240px] flex flex-col bg-content2">\r\n      <Dropdown\r\n        className="w-[230px]"\r\n        placement="bottom-start"\r\n        onOpenChange={open => {\r\n          setOpenDropdown(open)\r\n        }}\r\n      >\r\n        {/*  */}\r\n        <DropdownMenu aria-label="Group Actions" variant="flat">\r\n          <DropdownItem\r\n            key="user-info"\r\n            startContent={<PlusCircle className="w-5 h-5" />}\r\n            onClick={() => {\r\n              setOpenGroupModal(true)\r\n            }}\r\n          >\r\n            create a group chat\r\n          </DropdownItem>\r\n          <DropdownItem\r\n            key="change-password"\r\n            startContent={<UserPlus className="w-5 h-5" />}\r\n            onClick={() => {\r\n              setOpenJoinGroupModal(true)\r\n            }}\r\n          >\r\n            join a group chat\r\n          </DropdownItem>\r\n        </DropdownMenu>\r\n      </Dropdown>\r\n\r\n      {/*  */}\r\n\r\n      <GroupModal\r\n        open={openGroupModal}\r\n        close={() => setOpenGroupModal(false)}\r\n        confirmSuccess={getGroupList}\r\n      />\r\n\r\n      <JoinGroupModal\r\n        open={openJoinGroupModal}\r\n        close={() => setOpenJoinGroupModal(false)}\r\n        confirmSuccess={getGroupList}\r\n      />\r\n    </div>\r\n  )\r\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u6d4b\u8bd5\u4e00\u4e0b\u3002"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:e(3369).A+"",width:"1920",height:"1080"})}),"\n",(0,o.jsx)(n.h2,{id:"\u7fa4\u8be6\u60c5\u9875\u9762",children:"\u7fa4\u8be6\u60c5\u9875\u9762"}),"\n",(0,o.jsx)(n.h3,{id:"\u4e8c\u7ea7\u8def\u7531\u914d\u7f6e",children:"\u4e8c\u7ea7\u8def\u7531\u914d\u7f6e"}),"\n",(0,o.jsxs)(n.p,{children:["\u7fa4\u8be6\u60c5\u9875\u9762\u6211\u4eec\u5c06\u5176\u4f5c\u4e3a",(0,o.jsx)(n.code,{children:"contact"}),"\u7684\u4e8c\u7ea7\u8def\u7531\u53bb\u663e\u793a\u3002"]}),"\n",(0,o.jsxs)(n.p,{children:["\u5148\u7b80\u5355\u6dfb\u52a0\u4e00\u4e2a",(0,o.jsx)(n.code,{children:"ContactDetail"}),"\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",metastring:'title="app/client/src/pages/contact/contact-detail.tsx"',children:'export const ContactDetail = () => {\r\n  return (\r\n    <div className="h-full fc overflow-y-auto no-scrollbar bg-content3">\r\n      ContactDetail\r\n    </div>\r\n  )\r\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u5728",(0,o.jsx)(n.code,{children:"ContactPage"}),"\u91cc\u52a0\u4e0a",(0,o.jsx)(n.code,{children:"Outlet"}),"\uff0c\u540c\u65f6\u5bfc\u51fa",(0,o.jsx)(n.code,{children:"ContactDetail"}),"\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",metastring:'title="apps/client/src/pages/contact/index.tsx"',children:"import { Outlet } from 'react-router-dom'\r\nimport { Sidebar } from './sidebar'\r\nexport { ContactDetail } from './contact-detail'\r\n\r\nexport const ContactPage = () => {\r\n  return (\r\n    <div className=\"h-full flex flex-row\">\r\n      <Sidebar />\r\n\r\n      <main className=\"flex-1\">\r\n        <Outlet />\r\n      </main>\r\n    </div>\r\n  )\r\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u63a5\u4e0b\u6765\u5728",(0,o.jsx)(n.code,{children:"router"}),"\u6587\u4ef6\u5939\u6dfb\u52a0\u4e00\u4e2a",(0,o.jsx)(n.code,{children:"DefaultWrap"}),"\u7ec4\u4ef6\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",metastring:'title="apps/client/src/router/default-wrap.tsx"',children:"import React from 'react'\r\n\r\nexport const DefaultWrap = ({ children }: { children?: React.ReactNode }) => {\r\n  return (\r\n    <div className=\"h-full fc bg-content3 dark:bg-content3\">{children}</div>\r\n  )\r\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u5728",(0,o.jsx)(n.code,{children:"routes.tsx"}),"\u91cc\u6dfb\u52a0\u4e00\u4e0b\u914d\u7f6e\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",metastring:'title="apps/client/src/router/routes.tsx"',children:"// ...\r\nimport { Users } from 'lucide-react'\r\nimport { DefaultWrap } from './default-wrap'\r\nimport { ContactDetail, ContactPage } from '@/pages/contact'\r\n\r\nexport const routes = [\r\n  {\r\n    path: '/',\r\n    element: <AppLayout />,\r\n    children: [\r\n      // ...\r\n      {\r\n        path: 'contact',\r\n        element: <ContactPage />,\r\n        children: [\r\n          {\r\n            path: 'group/:groupId',\r\n            element: <ContactDetail />\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n  // ...\r\n]\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u4fee\u6539\u4e00\u4e0b",(0,o.jsx)(n.code,{children:"sidebar.tsx"}),"\u6587\u4ef6\uff0c\u5b9e\u73b0\u70b9\u51fb\u7fa4\u65f6\u8df3\u8f6c\u94fe\u63a5\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",metastring:'title="apps/client/src/pages/contact/sidebar.tsx"',children:"// ...\r\nimport {\r\n  // ...\r\n  useParams\r\n} from 'react-router-dom'\r\n\r\nconst GroupList: FC<GroupListProps> = ({ list }) => {\r\n  const navigate = useNavigate()\r\n\r\n  const { groupId } = useParams()\r\n  const isActived = (currentId: number) => {\r\n    return currentId === Number(groupId)\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {list.map((el, index) => (\r\n        <div\r\n          className={cn(\r\n            'flex items-center p-2 w-full cursor-pointer',\r\n            isActived(el.id) && 'bg-content3 dark:bg-content3'\r\n          )}\r\n          key={index}\r\n          onClick={() => {\r\n            navigate(`group/${el.id}`)\r\n          }}\r\n        >\r\n          <Avatar className=\"mr-2 flex-shrink-0\" src={el.cover?.url} />\r\n          <p className=\"text-ellipsis overflow-hidden break-all whitespace-nowrap text-base\">\r\n            {el.name}\r\n          </p>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n// ...\n"})}),"\n",(0,o.jsxs)(n.h3,{id:"contactdetail\u5b8c\u5584",children:[(0,o.jsx)(n.code,{children:"ContactDetail"}),"\u5b8c\u5584"]}),"\n",(0,o.jsxs)(n.p,{children:["\u6700\u540e\u5b8c\u5584\u4e00\u4e0b",(0,o.jsx)(n.code,{children:"ContactDetail"}),"\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",metastring:'title="apps/client/src/pages/contact/contact-detail.tsx"',children:'import { useCallback } from \'react\'\r\nimport { useParams } from \'react-router-dom\'\r\nimport {\r\n  Avatar,\r\n  AvatarGroup,\r\n  Button,\r\n  CircularProgress,\r\n  Divider,\r\n  Snippet,\r\n  Tooltip\r\n} from \'@nextui-org/react\'\r\nimport { MessageSquare } from \'lucide-react\'\r\nimport { groupApi } from \'@/api\'\r\nimport { useApi } from \'@/api/use-api\'\r\nimport { GroupVo } from \'@ying-chat/shared\'\r\n\r\nexport const ContactDetail = () => {\r\n  const { groupId } = useParams()\r\n  const { loading, data } = useApi<GroupVo>({\r\n    func: useCallback(() => groupApi.getGroupInfo(groupId!), [groupId])\r\n  })\r\n\r\n  const Detail = () => {\r\n    if (!data) {\r\n      return null\r\n    }\r\n\r\n    return (\r\n      <div className="w-[50%] h-[50%]">\r\n        <div className="flex items-center">\r\n          <Avatar src={data.cover?.url} className="w-24 h-24" />\r\n          <p className="text-ellipsis overflow-hidden break-all whitespace-nowrap text-2xl ml-4 flex-1">\r\n            {data.name}\r\n          </p>\r\n          <Button color="primary" isIconOnly className="rounded-full w-16 h-16">\r\n            <MessageSquare size={30} />\r\n          </Button>\r\n        </div>\r\n\r\n        <Divider className="my-4" />\r\n\r\n        {data.inviteCode && (\r\n          <div className="mb-2 flex justify-between items-center">\r\n            <p className="text-lg mb-1">\u9080\u8bf7\u7801</p>\r\n            <Snippet symbol="" className="bg-content4 dark:bg-content4">\r\n              {data.inviteCode}\r\n            </Snippet>\r\n          </div>\r\n        )}\r\n\r\n        <div className="mb-2">\r\n          <p className="text-lg mb-1">\u7fa4\u4ecb\u7ecd</p>\r\n          <p className="break-all">{data.description}</p>\r\n        </div>\r\n\r\n        <div className="mb-2">\r\n          <p className="text-lg mb-1">\u7fa4\u6210\u5458({data.users?.length})</p>\r\n          <AvatarGroup className="justify-start" size="lg">\r\n            {data.users?.map(user => (\r\n              <Tooltip content={user.nickname} key={user.id}>\r\n                <Avatar src={user.avatar?.url} isBordered />\r\n              </Tooltip>\r\n            ))}\r\n          </AvatarGroup>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className="h-full fc overflow-y-auto no-scrollbar bg-content3">\r\n      {loading ? (\r\n        <CircularProgress size="lg" aria-label="Loading..." />\r\n      ) : (\r\n        <Detail />\r\n      )}\r\n    </div>\r\n  )\r\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u518d\u521b\u5efa\u4e00\u4e2a\u7fa4\u7ec4\u6d4b\u8bd5\u4e00\u4e0b\u3002"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:e(2702).A+"",width:"1920",height:"1080"})}),"\n",(0,o.jsx)(n.p,{children:"\u6700\u540e\u521b\u5efa\u53e6\u4e00\u4e2a\u8d26\u53f7\uff0c\u7136\u540e\u6d4b\u8bd5\u4e00\u4e0b\u52a0\u5165\u7fa4\u7ec4\u3002"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:e(1863).A+"",width:"1920",height:"1080"})}),"\n",(0,o.jsx)(n.p,{children:"\u672c\u8282\u5230\u6b64\u7ed3\u675f\u3002"})]})}function p(r={}){const{wrapper:n}={...(0,t.R)(),...r.components};return n?(0,o.jsx)(n,{...r,children:(0,o.jsx)(d,{...r})}):d(r)}},3369:(r,n,e)=>{e.d(n,{A:()=>o});const o=e.p+"assets/images/01-63fd7189e106deb2ae43639b8cdc9dce.gif"},2702:(r,n,e)=>{e.d(n,{A:()=>o});const o=e.p+"assets/images/02-59e94d02556fc0b1dc54b06e7926dddb.gif"},1863:(r,n,e)=>{e.d(n,{A:()=>o});const o=e.p+"assets/images/03-75dd864d97a21d12789eaac2ba2b8b41.gif"},9128:(r,n,e)=>{e.d(n,{R:()=>s,x:()=>i});var o=e(9474);const t={},a=o.createContext(t);function s(r){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof r?r(n):{...n,...r}}),[n,r])}function i(r){let n;return n=r.disableParentContext?"function"==typeof r.components?r.components(t):r.components||t:s(r.components),o.createElement(a.Provider,{value:n},r.children)}}}]);